var CryptoJS = require("pbkdf2.js")
	,	crypto = (function(){
			function cryptFunc(pass, salt){
				return CryptoJS.PBKDF2(pass, salt, { keySize: 1024/32, iterations: 1024 }).toString(CryptoJS.enc.Hex);
			}	
			
			function random(){
				return CryptoJS.lib.WordArray.random(32).toString();
			}
			
			function encrypt(password){
				var salt = random()
					,	hash = cryptFunc(password, salt);

				return {
					hash: hash
				,	salt: salt
				};
			}

			function isPassword(givenPass, storedPass, storedSalt){
				return storedPass === cryptFunc(givenPass, storedSalt);
			}
			return {
				encrypt: encrypt
			,	isPassword: isPassword
			,	random: random
			};
	})();
module.exports = crypto;
